"use strict";(self["webpackChunkvue3_pwa"]=self["webpackChunkvue3_pwa"]||[]).push([[150],{5150:function(e,t,i){i.r(t),i.d(t,{default:function(){return Be}});var o=i(3396),l=i(7139);const a={class:"container-page-recipe"},s={class:"recipeDetail-list"},n={class:"recipeDetail-title"},r={class:"recipeDetail-btn"},d=["onClick"],c=(0,o._)("i",{class:"bi bi-pencil-fill"},null,-1),u=[c],p=["onClick"],h=(0,o._)("i",{class:"bi bi-trash3-fill"},null,-1),m=[h],_={class:"addBtn"},f=(0,o._)("i",{class:"bi bi-plus-lg"},null,-1),b=[f];function g(e,t,i,c,h,f){const g=(0,o.up)("loading"),D=(0,o.up)("RecipeModal"),v=(0,o.up)("RecipeEditModal"),y=(0,o.up)("RecipeDelModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",a,[(0,o._)("ul",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(h.recipelist,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"recipeDetail-type",key:e.recipe_id},[(0,o._)("div",n,[(0,o._)("h3",null,(0,l.zw)(e.name),1)]),(0,o._)("div",r,[(0,o._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t=>f.openModal("editModal",e)},u,8,d),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>f.openModal("delModal",e)},m,8,p)])])))),128))]),(0,o._)("div",_,[(0,o._)("button",{type:"button",onClick:t[0]||(t[0]=e=>f.openModal(""))},b)])]),(0,o.Wm)(g,{active:e.isLoading},null,8,["active"]),(0,o.Wm)(D,{"category-data":h.localCategoryID,"info-detail":h.recipe_InfoDetails,onAddRecipe:t[1]||(t[1]=e=>f.closeModal(""))},null,8,["category-data","info-detail"]),(0,o.Wm)(v,{"info-detail":h.recipe_InfoDetails,onEditRecipe:t[2]||(t[2]=e=>f.closeModal("editModal"))},null,8,["info-detail"]),(0,o.Wm)(y,{"info-detail":h.recipe_InfoDetails,onDeleteRecipe:t[3]||(t[3]=e=>f.closeModal("delModal"))},null,8,["info-detail"])],64)}var D=i(2166),v=i(5513),y=i.n(v),N=i(65),M=i(9242);const w={id:"recipeModal",ref:"recipeModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-xl container-modal"},I={class:"modal-header bg-dark text-white"},k={id:"recipeModalLabel",class:"modal-title"},x={class:"modal-body"},$={class:"row"},E={class:"col-sm body-content"},R={class:"content-header"},L={class:"form-group col content-recipeName"},V={class:"nutrition-label"},W=(0,o._)("label",{for:"nutrition"},"食材選擇：",-1),z=(0,o._)("option",{value:"",selected:"",disabled:""},"請選擇食材",-1),J=["value"],A={class:"form-group col content-nutritions"},O={class:"nutrition-selected"},S=(0,o._)("label",{for:""},"已加入：",-1),U={class:"nutrition-list"},H=(0,o._)("i",{class:"bi bi-trash3-fill"},null,-1),Z=(0,o._)("span",null," 清除",-1),q=[H,Z],P={class:"form-textarea mb-4"},T=(0,o._)("div",{class:"form-label"},[(0,o._)("label",{for:"step"},"步驟做法：")],-1),B={class:"modal-footer"};function Y(e,t,i,a,s,n){const r=(0,o.up)("v-field"),d=(0,o.up)("error-message"),c=(0,o.up)("v-form");return(0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("div",C,[(0,o.Wm)(c,{class:"modal-content border-0"},{default:(0,o.w5)((({errors:e})=>[(0,o._)("div",I,[(0,o._)("h5",k,[(0,o._)("span",null,"新增"+(0,l.zw)(i.infoDetail.category_name)+"食譜",1)]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>n.closeClearData&&n.closeClearData(...e))})]),(0,o._)("div",x,[(0,o._)("div",$,[(0,o._)("div",E,[(0,o._)("div",R,[(0,o._)("div",L,[(0,o.Wm)(r,{id:"recipe_name",name:"食譜名稱",type:"text",modelValue:i.infoDetail.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.infoDetail.name=e),placeholder:"請輸入食譜名稱",rules:{required:!0,max:10},class:(0,l.C_)({"is-invalid":e["食譜名稱"]})},null,8,["modelValue","class"]),(0,o.Wm)(d,{name:"食譜名稱",class:"invalid-feedback"})]),(0,o._)("div",V,[W,(0,o.wy)((0,o._)("select",{id:"nutrition","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedNutritionID=e)},[z,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.nutritions,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.nutrition_id,key:e.nutrition_id},(0,l.zw)(e.name),9,J)))),128))],512),[[M.bM,s.selectedNutritionID]]),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[3]||(t[3]=(...e)=>n.select_Nutrition&&n.select_Nutrition(...e))},"加入")])]),(0,o._)("div",A,[(0,o._)("div",O,[S,(0,o._)("ul",U,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.selectedNutritions,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"nutrition-item",key:e.nutrition_id},[(0,o._)("span",null,(0,l.zw)(e.name),1)])))),128))]),(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[4]||(t[4]=(...e)=>n.remove_Nutrition&&n.remove_Nutrition(...e))},q)])]),(0,o._)("div",P,[T,(0,o.wy)((0,o._)("textarea",{id:"step",type:"text",name:"textarea",class:"form-control",rows:"10",cols:"20","onUpdate:modelValue":t[5]||(t[5]=e=>i.infoDetail.step=e),required:""},null,512),[[M.nr,i.infoDetail.step]])])])])]),(0,o._)("div",B,[(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>n.confirmPost&&n.confirmPost(...e))},"發佈")])])),_:1})])],512)}i(7658);var j=i(5708),K=i(3990),F=i(579),Q=i(2389),G=i(8456);Object.keys(K.ZP).forEach((e=>{(0,j.aH)(e,K.ZP[e])})),(0,j.jQ)({generateMessage:(0,F.NC)({zh_TW:Q}),validateOnInput:!0}),(0,F.i_)("zh_TW");var X={data(){return{fixApi:"https://140.123.173.4",nutritions:[],selectedNutritions:[],selectedNutritionID:""}},methods:{getNutrition(){const e=`${this.fixApi}/nutrition`;this.$http.get(e).then((e=>{this.nutritions=e.data})).catch((e=>{console.log(e)}))},select_Nutrition(){if(""!==this.selectedNutritionID)if(this.selectedNutritions.length<4){const e=this.nutritions.find((e=>e.nutrition_id===this.selectedNutritionID));e&&this.selectedNutritions.push(e),this.selectedNutritionID=""}else(0,G.Jt)("食材最多只能選擇4項");else(0,G.Jt)("未選擇食材項目")},remove_Nutrition(){0!==this.selectedNutritions.length&&(this.selectedNutritions=[],this.selectedNutritionID="")},confirmPost(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.categoryData}`;this.$http.post(e,this.infoDetailCopy).then((e=>{this.$emit("addRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,G.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,G.Jt)(e.response.data.msg)}))},closeClearData(){this.selectedNutritionID="",this.selectedNutritions=[]}},computed:{infoDetailCopy(){const e={...this.infoDetail};return e.nutrition=this.selectedNutritions,e}},props:{infoDetail:{default:{}},categoryData:{default:""}},emits:["addRecipe"],components:{VField:j.gN,VForm:j.l0,ErrorMessage:j.Bc},created(){this.getNutrition(),this.selectedNutritionID="",this.selectedNutritions=[]}},ee=i(89);const te=(0,ee.Z)(X,[["render",Y]]);var ie=te;const oe={id:"recipeEditModal",ref:"recipeEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeEditModalLabel","aria-hidden":"true"},le={class:"modal-dialog modal-xl container-modal"},ae={class:"modal-header bg-dark text-white"},se={id:"recipeEditModalLabel",class:"modal-title"},ne={class:"modal-body"},re={class:"row"},de={class:"col-sm body-content"},ce={class:"content-header"},ue={class:"form-group col content-recipeName"},pe={class:"nutrition-label"},he=(0,o._)("label",{for:"nutrition"},"食材選擇：",-1),me=(0,o._)("option",{value:"",selected:"",disabled:""},"請選擇食材",-1),_e=["value"],fe={class:"form-group col content-nutritions"},be={class:"nutrition-selected"},ge=(0,o._)("label",{for:""},"已加入：",-1),De={class:"nutrition-list"},ve=(0,o._)("i",{class:"bi bi-trash3-fill"},null,-1),ye=(0,o._)("span",null," 清除",-1),Ne=[ve,ye],Me={class:"form-textarea mb-4"},we=(0,o._)("div",{class:"form-label"},[(0,o._)("label",{for:"step"},"步驟做法：")],-1),Ce={class:"modal-footer"};function Ie(e,t,i,a,s,n){const r=(0,o.up)("v-field"),d=(0,o.up)("error-message"),c=(0,o.up)("v-form");return(0,o.wg)(),(0,o.iD)("div",oe,[(0,o._)("div",le,[(0,o.Wm)(c,{class:"modal-content border-0"},{default:(0,o.w5)((({errors:e})=>[(0,o._)("div",ae,[(0,o._)("h5",se,[(0,o._)("span",null,"編輯"+(0,l.zw)(i.infoDetail.category_name)+"食譜",1)]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>n.closeClearData&&n.closeClearData(...e))})]),(0,o._)("div",ne,[(0,o._)("div",re,[(0,o._)("div",de,[(0,o._)("div",ce,[(0,o._)("div",ue,[(0,o.Wm)(r,{id:"recipe_name",name:"食譜名稱",type:"text",modelValue:i.infoDetail.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.infoDetail.name=e),placeholder:"請輸入食譜名稱",rules:{required:!0,max:10},class:(0,l.C_)({"is-invalid":e["食譜名稱"]})},null,8,["modelValue","class"]),(0,o.Wm)(d,{name:"食譜名稱",class:"invalid-feedback"})]),(0,o._)("div",pe,[he,(0,o.wy)((0,o._)("select",{id:"nutrition","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedNutritionID=e)},[me,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.nutritions,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.nutrition_id,key:e.nutrition_id},(0,l.zw)(e.name),9,_e)))),128))],512),[[M.bM,s.selectedNutritionID]]),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[3]||(t[3]=(...e)=>n.select_Nutrition&&n.select_Nutrition(...e))},"加入")])]),(0,o._)("div",fe,[(0,o._)("div",be,[ge,(0,o._)("ul",De,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.selectedNutritions,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"nutrition-item",key:e.nutrition_id},[(0,o._)("span",null,(0,l.zw)(e.name),1)])))),128))]),(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[4]||(t[4]=(...e)=>n.remove_Nutrition&&n.remove_Nutrition(...e))},Ne)])]),(0,o._)("div",Me,[we,(0,o.wy)((0,o._)("textarea",{id:"step",type:"text",name:"textarea",class:"form-control",rows:"10",cols:"20","onUpdate:modelValue":t[5]||(t[5]=e=>i.infoDetail.step=e),required:""},null,512),[[M.nr,i.infoDetail.step]])])])])]),(0,o._)("div",Ce,[(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>n.confirmEdit&&n.confirmEdit(...e))},"更新")])])),_:1})])],512)}Object.keys(K.ZP).forEach((e=>{(0,j.aH)(e,K.ZP[e])})),(0,j.jQ)({generateMessage:(0,F.NC)({zh_TW:Q}),validateOnInput:!0}),(0,F.i_)("zh_TW");var ke={data(){return{fixApi:"https://140.123.173.4",nutritions:[],selectedNutritions:[],selectedNutritionID:""}},methods:{getNutrition(){const e=`${this.fixApi}/nutrition`;this.$http.get(e).then((e=>{this.nutritions=e.data})).catch((e=>{console.log(e)}))},getSelectedNutritions(){if(this.infoDetail&&this.infoDetail.nutrition)try{this.selectedNutritions=JSON.parse(this.infoDetail.nutrition)}catch(e){console.error("Error parsing infoDetail.nutrition:",e),this.selectedNutritions=[]}},select_Nutrition(){if(""!==this.selectedNutritionID)if(this.selectedNutritions.length<4){const e=this.nutritions.find((e=>e.nutrition_id===this.selectedNutritionID));e&&this.selectedNutritions.push(e),this.selectedNutritionID=""}else(0,G.Jt)("食材最多只能選擇4項");else(0,G.Jt)("未選擇食材項目")},remove_Nutrition(){0!==this.selectedNutritions.length&&(this.selectedNutritions=[],this.selectedNutritionID="")},confirmEdit(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.infoDetail.category_id}/${this.infoDetail.recipe_id}`;this.$http.put(e,this.infoDetailCopy).then((e=>{this.$emit("editRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,G.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,G.Jt)(e.response.data.msg)}))},closeClearData(){this.selectedNutritionID="",this.selectedNutritions=[]}},watch:{infoDetail:{handler(){this.getSelectedNutritions()},deep:!0,immediate:!0}},computed:{infoDetailCopy(){const e={...this.infoDetail};return e.nutrition=this.selectedNutritions,e}},props:{infoDetail:{type:Object,default:()=>({})}},emits:["editRecipe"],components:{VField:j.gN,VForm:j.l0,ErrorMessage:j.Bc},created(){this.getNutrition(),this.selectedNutritionID=""}};const xe=(0,ee.Z)(ke,[["render",Ie]]);var $e=xe;const Ee={id:"recipeDelModal",ref:"recipeDelModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeDelModalLabel","aria-hidden":"true"},Re={class:"modal-dialog"},Le={class:"modal-content border-0"},Ve={class:"modal-header bg-danger text-white"},We={id:"recipeDelModalLabel",class:"modal-title"},ze=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Je={class:"modal-body"},Ae={class:"text-danger"},Oe={class:"modal-footer"},Se=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function Ue(e,t,i,a,s,n){return(0,o.wg)(),(0,o.iD)("div",Ee,[(0,o._)("div",Re,[(0,o._)("div",Le,[(0,o._)("div",Ve,[(0,o._)("h5",We,[(0,o._)("span",null,"刪除"+(0,l.zw)(i.infoDetail.category_name)+"食譜",1)]),ze]),(0,o._)("div",Je,[(0,o.Uk)(" 是否刪除 "),(0,o._)("strong",Ae,(0,l.zw)(i.infoDetail.name),1),(0,o.Uk)(" 食譜(刪除後將無法恢復)。 ")]),(0,o._)("div",Oe,[Se,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>n.confirmDel&&n.confirmDel(...e))},"確認刪除")])])])],512)}var He={data(){return{fixApi:"https://140.123.173.4"}},methods:{confirmDel(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.infoDetail.category_id}/${this.infoDetail.recipe_id}`;this.$http.delete(e).then((e=>{this.$emit("deleteRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,G.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,G.Jt)(e.response.data.msg)}))}},props:{infoDetail:{default:{}}},emits:["deleteRecipe"]};const Ze=(0,ee.Z)(He,[["render",Ue]]);var qe=Ze,Pe={data(){return{fixApi:"https://140.123.173.4",localCategoryID:this.category_id,recipelist:[],recipe_InfoDetails:{},recipeModal:{},recipeEditModal:{},recipeDelModal:{}}},methods:{getRecipeCategory(){const e=`${this.fixApi}/recipe/${this.localCategoryID}`;this.$http.get(e).then((e=>{this.recipelist=e.data}))},openModal(e,t){""===e?(this.recipe_InfoDetails={},this.recipeModal.show()):"editModal"===e?(this.recipe_InfoDetails=JSON.parse(JSON.stringify(t)),this.recipeEditModal.show()):"delModal"===e?(this.recipe_InfoDetails=JSON.parse(JSON.stringify(t)),this.recipeDelModal.show()):console.log("openModal Error！！")},closeModal(e){""===e?this.recipeModal.hide():"editModal"===e?this.recipeEditModal.hide():"delModal"===e?this.recipeDelModal.hide():console.log("closeModal Error！！"),this.getRecipeCategory()}},computed:{...(0,N.Se)(["isLoading"])},props:{category_id:String},components:{RecipeModal:ie,RecipeEditModal:$e,RecipeDelModal:qe,Loading:y()},created(){this.getRecipeCategory()},mounted(){this.recipeModal=new D.u_(document.getElementById("recipeModal")),this.recipeEditModal=new D.u_(document.getElementById("recipeEditModal")),this.recipeDelModal=new D.u_(document.getElementById("recipeDelModal"))},beforeRouteUpdate(e,t){const i=e.path,o=t.path;console.log(i),console.log(o),this.localCategoryID=e.params.category_id,this.getRecipeCategory()}};const Te=(0,ee.Z)(Pe,[["render",g]]);var Be=Te}}]);
//# sourceMappingURL=150.0394f551.js.map