"use strict";(self["webpackChunkvue3_pwa"]=self["webpackChunkvue3_pwa"]||[]).push([[592],{7592:function(e,t,i){i.r(t),i.d(t,{default:function(){return He}});var l=i(3396),o=i(7139);const a={class:"container-page"},s={class:"recipeDetail-list"},n={class:"recipeDetail-title"},d={class:"recipeDetail-btn"},r=["onClick"],c=(0,l._)("i",{class:"bi bi-pencil-fill"},null,-1),u=[c],p=["onClick"],h=(0,l._)("i",{class:"bi bi-trash3-fill"},null,-1),m=[h],_={class:"addBtn"},f=(0,l._)("i",{class:"bi bi-plus-lg"},null,-1),g=[f];function b(e,t,i,c,h,f){const b=(0,l.up)("loading"),D=(0,l.up)("RecipeModal"),v=(0,l.up)("RecipeEditModal"),y=(0,l.up)("RecipeDelModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",a,[(0,l._)("ul",s,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(h.recipelist,(e=>((0,l.wg)(),(0,l.iD)("li",{class:"recipeDetail-type",key:e.recipe_id},[(0,l._)("div",n,[(0,l._)("h3",null,(0,o.zw)(e.name),1)]),(0,l._)("div",d,[(0,l._)("button",{class:"btn btn-outline-primary",onClick:t=>f.openModal("editModal",e)},u,8,r),(0,l._)("button",{class:"btn btn-outline-danger",onClick:t=>f.openModal("delModal",e)},m,8,p)])])))),128))]),(0,l._)("div",_,[(0,l._)("button",{class:"",onClick:t[0]||(t[0]=e=>f.openModal(""))},g)])]),(0,l.Wm)(b,{active:e.isLoading},null,8,["active"]),(0,l.Wm)(D,{"category-data":h.localCategoryID,"info-detail":h.recipe_InfoDetails,onAddRecipe:t[1]||(t[1]=e=>f.closeModal(""))},null,8,["category-data","info-detail"]),(0,l.Wm)(v,{"info-detail":h.recipe_InfoDetails,onEditRecipe:t[2]||(t[2]=e=>f.closeModal("editModal"))},null,8,["info-detail"]),(0,l.Wm)(y,{"info-detail":h.recipe_InfoDetails,onDeleteRecipe:t[3]||(t[3]=e=>f.closeModal("delModal"))},null,8,["info-detail"])],64)}var D=i(2166),v=i(5513),y=i.n(v),M=i(65),N=i(9242);const w={id:"recipeModal",ref:"recipeModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-xl"},I={class:"modal-header bg-dark text-white"},x={id:"recipeModalLabel",class:"modal-title"},k={class:"modal-body"},$={class:"row"},E={class:"col-sm"},R={class:"form-group col"},L=(0,l._)("label",{for:"recipe_name"},"食譜名稱：",-1),V={class:"form-group col"},W={class:"nutrition-label"},z=(0,l._)("label",{for:"nutrition"},"請選擇食材：",-1),A=(0,l._)("option",{value:"",selected:"",disabled:""},"請選擇食材",-1),O=["value"],S={class:"nutrition-selected"},U=(0,l._)("label",{for:""},"已加入：",-1),H={class:"nutrition-list"},J={class:"form-textarea mb-4"},Z=(0,l._)("div",{class:"form-label"},[(0,l._)("label",{for:"step"},"步驟做法：")],-1),q={class:"modal-footer"};function P(e,t,i,a,s,n){const d=(0,l.up)("v-field"),r=(0,l.up)("error-message"),c=(0,l.up)("v-form");return(0,l.wg)(),(0,l.iD)("div",w,[(0,l._)("div",C,[(0,l.Wm)(c,{class:"modal-content border-0"},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",I,[(0,l._)("h5",x,[(0,l._)("span",null,"新增"+(0,o.zw)(i.infoDetail.category_name)+"食譜",1)]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>n.closeClearData&&n.closeClearData(...e))})]),(0,l._)("div",k,[(0,l._)("div",$,[(0,l._)("div",E,[(0,l._)("div",R,[L,(0,l.Wm)(d,{id:"recipe_name",name:"食譜名稱",type:"text",modelValue:i.infoDetail.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.infoDetail.name=e),rules:{required:!0,max:10},class:(0,o.C_)({"is-invalid":e["食譜名稱"]})},null,8,["modelValue","class"]),(0,l.Wm)(r,{name:"食譜名稱",class:"invalid-feedback"})]),(0,l._)("div",V,[(0,l._)("div",W,[z,(0,l.wy)((0,l._)("select",{id:"nutrition","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedNutritionID=e)},[A,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.nutritions,(e=>((0,l.wg)(),(0,l.iD)("option",{value:e.nutrition_id,key:e.nutrition_id},(0,o.zw)(e.name),9,O)))),128))],512),[[N.bM,s.selectedNutritionID]]),(0,l._)("button",{class:"btn btn-outline-danger",onClick:t[3]||(t[3]=(...e)=>n.select_Nutrition&&n.select_Nutrition(...e))},"加入")]),(0,l._)("div",S,[U,(0,l._)("ul",H,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.selectedNutritions,(e=>((0,l.wg)(),(0,l.iD)("li",{class:"nutrition-item",key:e.nutrition_id},[(0,l._)("p",null,(0,o.zw)(e.name),1)])))),128))])])]),(0,l._)("div",J,[Z,(0,l.wy)((0,l._)("textarea",{id:"step",type:"text",name:"textarea",class:"form-control",rows:"10",cols:"20","onUpdate:modelValue":t[4]||(t[4]=e=>i.infoDetail.step=e),required:""},null,512),[[N.nr,i.infoDetail.step]])])])])]),(0,l._)("div",q,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>n.confirmPost&&n.confirmPost(...e))},"發佈")])])),_:1})])],512)}i(7658);var T=i(5708),B=i(3990),Y=i(579),j=i(2389),K=i(8456);Object.keys(B.ZP).forEach((e=>{(0,T.aH)(e,B.ZP[e])})),(0,T.jQ)({generateMessage:(0,Y.NC)({zh_TW:j}),validateOnInput:!0}),(0,Y.i_)("zh_TW");var F={data(){return{fixApi:"https://140.123.173.4",nutritions:[],selectedNutritions:[],selectedNutritionID:""}},methods:{getNutrition(){const e=`${this.fixApi}/nutrition`;this.$http.get(e).then((e=>{this.nutritions=e.data})).catch((e=>{console.log(e)}))},select_Nutrition(){if(""!==this.selectedNutritionID){const e=this.nutritions.find((e=>e.nutrition_id===this.selectedNutritionID));e&&this.selectedNutritions.push(e),this.selectedNutritionID=""}},confirmPost(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.categoryData}`;this.$http.post(e,this.infoDetailCopy).then((e=>{this.$emit("addRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,K.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,K.Jt)(e.response.data.msg)}))},closeClearData(){this.selectedNutritionID="",this.selectedNutritions=[]}},computed:{infoDetailCopy(){const e={...this.infoDetail};return e.nutrition=this.selectedNutritions,e}},props:{infoDetail:{default:{}},categoryData:{default:""}},emits:["addRecipe"],components:{VField:T.gN,VForm:T.l0,ErrorMessage:T.Bc},created(){this.getNutrition(),this.selectedNutritionID="",this.selectedNutritions=[]}},Q=i(89);const G=(0,Q.Z)(F,[["render",P]]);var X=G;const ee={id:"recipeEditModal",ref:"recipeEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeEditModalLabel","aria-hidden":"true"},te={class:"modal-dialog modal-xl"},ie={class:"modal-header bg-dark text-white"},le={id:"recipeEditModalLabel",class:"modal-title"},oe={class:"modal-body"},ae={class:"row"},se={class:"col-sm"},ne={class:"form-group col"},de=(0,l._)("label",{for:"recipe_name"},"食譜名稱：",-1),re={class:"form-group col"},ce={class:"nutrition-label"},ue=(0,l._)("label",{for:"nutrition"},"請選擇食材：",-1),pe=(0,l._)("option",{value:"",selected:"",disabled:""},"請選擇食材",-1),he=["value"],me={class:"nutrition-selected"},_e=(0,l._)("label",{for:""},"已加入：",-1),fe={class:"nutrition-list"},ge={class:"form-textarea mb-4"},be=(0,l._)("div",{class:"form-label"},[(0,l._)("label",{for:"step"},"步驟做法：")],-1),De={class:"modal-footer"};function ve(e,t,i,a,s,n){const d=(0,l.up)("v-field"),r=(0,l.up)("error-message"),c=(0,l.up)("v-form");return(0,l.wg)(),(0,l.iD)("div",ee,[(0,l._)("div",te,[(0,l.Wm)(c,{class:"modal-content border-0"},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",ie,[(0,l._)("h5",le,[(0,l._)("span",null,"編輯"+(0,o.zw)(i.infoDetail.category_name)+"食譜",1)]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>n.closeClearData&&n.closeClearData(...e))})]),(0,l._)("div",oe,[(0,l._)("div",ae,[(0,l._)("div",se,[(0,l._)("div",ne,[de,(0,l.Wm)(d,{id:"recipe_name",name:"食譜名稱",type:"text",modelValue:i.infoDetail.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.infoDetail.name=e),rules:{required:!0,max:10},class:(0,o.C_)({"is-invalid":e["食譜名稱"]})},null,8,["modelValue","class"]),(0,l.Wm)(r,{name:"食譜名稱",class:"invalid-feedback"})]),(0,l._)("div",re,[(0,l._)("div",ce,[ue,(0,l.wy)((0,l._)("select",{id:"nutrition","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedNutritionID=e)},[pe,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.nutritions,(e=>((0,l.wg)(),(0,l.iD)("option",{value:e.nutrition_id,key:e.nutrition_id},(0,o.zw)(e.name),9,he)))),128))],512),[[N.bM,s.selectedNutritionID]]),(0,l._)("button",{class:"btn btn-outline-danger",onClick:t[3]||(t[3]=(...e)=>n.select_Nutrition&&n.select_Nutrition(...e))},"加入")]),(0,l._)("div",me,[_e,(0,l._)("ul",fe,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.selectedNutritions,(e=>((0,l.wg)(),(0,l.iD)("li",{class:"nutrition-item",key:e.nutrition_id},[(0,l._)("p",null,(0,o.zw)(e.name),1)])))),128))])])]),(0,l._)("div",ge,[be,(0,l.wy)((0,l._)("textarea",{id:"step",type:"text",name:"textarea",class:"form-control",rows:"10",cols:"20","onUpdate:modelValue":t[4]||(t[4]=e=>i.infoDetail.step=e),required:""},null,512),[[N.nr,i.infoDetail.step]])])])])]),(0,l._)("div",De,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>n.confirmEdit&&n.confirmEdit(...e))},"更新")])])),_:1})])],512)}Object.keys(B.ZP).forEach((e=>{(0,T.aH)(e,B.ZP[e])})),(0,T.jQ)({generateMessage:(0,Y.NC)({zh_TW:j}),validateOnInput:!0}),(0,Y.i_)("zh_TW");var ye={data(){return{fixApi:"https://140.123.173.4",nutritions:[],selectedNutritions:[],selectedNutritionID:""}},methods:{getNutrition(){const e=`${this.fixApi}/nutrition`;this.$http.get(e).then((e=>{this.nutritions=e.data})).catch((e=>{console.log(e)}))},getSelectedNutritions(){if(this.infoDetail&&this.infoDetail.nutrition)try{this.selectedNutritions=JSON.parse(this.infoDetail.nutrition)}catch(e){console.error("Error parsing infoDetail.nutrition:",e),this.selectedNutritions=[]}},select_Nutrition(){if(""!==this.selectedNutritionID){const e=this.nutritions.find((e=>e.nutrition_id===this.selectedNutritionID));e&&this.selectedNutritions.push(e),this.selectedNutritionID=""}},confirmEdit(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.infoDetail.category_id}/${this.infoDetail.recipe_id}`;this.$http.put(e,this.infoDetailCopy).then((e=>{this.$emit("editRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,K.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,K.Jt)(e.response.data.msg)}))},closeClearData(){this.selectedNutritionID="",this.selectedNutritions=[]}},watch:{infoDetail:{handler(){this.getSelectedNutritions()},deep:!0,immediate:!0}},computed:{infoDetailCopy(){const e={...this.infoDetail};return e.nutrition=this.selectedNutritions,e}},props:{infoDetail:{type:Object,default:()=>({})}},emits:["editRecipe"],components:{VField:T.gN,VForm:T.l0,ErrorMessage:T.Bc},created(){this.getNutrition(),this.selectedNutritionID=""}};const Me=(0,Q.Z)(ye,[["render",ve]]);var Ne=Me;const we={id:"recipeDelModal",ref:"recipeDelModal",class:"modal fade",tabindex:"-1","aria-labelledby":"recipeDelModalLabel","aria-hidden":"true"},Ce={class:"modal-dialog"},Ie={class:"modal-content border-0"},xe={class:"modal-header bg-danger text-white"},ke={id:"recipeDelModalLabel",class:"modal-title"},$e=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ee={class:"modal-body"},Re={class:"text-danger"},Le={class:"modal-footer"},Ve=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function We(e,t,i,a,s,n){return(0,l.wg)(),(0,l.iD)("div",we,[(0,l._)("div",Ce,[(0,l._)("div",Ie,[(0,l._)("div",xe,[(0,l._)("h5",ke,[(0,l._)("span",null,"刪除"+(0,o.zw)(i.infoDetail.category_name)+"食譜",1)]),$e]),(0,l._)("div",Ee,[(0,l.Uk)(" 是否刪除 "),(0,l._)("strong",Re,(0,o.zw)(i.infoDetail.name),1),(0,l.Uk)(" 食譜(刪除後將無法恢復)。 ")]),(0,l._)("div",Le,[Ve,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>n.confirmDel&&n.confirmDel(...e))},"確認刪除")])])])],512)}var ze={data(){return{fixApi:"https://140.123.173.4"}},methods:{confirmDel(){this.$store.dispatch("startLoading");const e=`${this.fixApi}/recipe/${this.infoDetail.category_id}/${this.infoDetail.recipe_id}`;this.$http.delete(e).then((e=>{this.$emit("deleteRecipe"),console.log(e.data),setTimeout((()=>{this.$store.dispatch("stopLoading")}),350),(0,K.qp)(e.data.msg)})).catch((e=>{console.log(e),(0,K.Jt)(e.response.data.msg)}))}},props:{infoDetail:{default:{}}},emits:["deleteRecipe"]};const Ae=(0,Q.Z)(ze,[["render",We]]);var Oe=Ae,Se={data(){return{fixApi:"https://140.123.173.4",localCategoryID:this.category_id,recipelist:[],recipe_InfoDetails:{},recipeModal:{},recipeEditModal:{},recipeDelModal:{}}},methods:{getRecipeCategory(){const e=`${this.fixApi}/recipe/${this.localCategoryID}`;this.$http.get(e).then((e=>{this.recipelist=e.data}))},openModal(e,t){""===e?(this.recipe_InfoDetails={},this.recipeModal.show()):"editModal"===e?(this.recipe_InfoDetails=JSON.parse(JSON.stringify(t)),this.recipeEditModal.show()):"delModal"===e?(this.recipe_InfoDetails=JSON.parse(JSON.stringify(t)),this.recipeDelModal.show()):console.log("openModal Error！！")},closeModal(e){""===e?this.recipeModal.hide():"editModal"===e?this.recipeEditModal.hide():"delModal"===e?this.recipeDelModal.hide():console.log("closeModal Error！！"),this.getRecipeCategory()}},computed:{...(0,M.Se)(["isLoading"])},props:{category_id:String},components:{RecipeModal:X,RecipeEditModal:Ne,RecipeDelModal:Oe,Loading:y()},created(){this.getRecipeCategory()},mounted(){this.recipeModal=new D.u_(document.getElementById("recipeModal")),this.recipeEditModal=new D.u_(document.getElementById("recipeEditModal")),this.recipeDelModal=new D.u_(document.getElementById("recipeDelModal"))},beforeRouteUpdate(e,t){const i=e.path,l=t.path;console.log(i),console.log(l),this.localCategoryID=e.params.category_id,this.getRecipeCategory()}};const Ue=(0,Q.Z)(Se,[["render",b]]);var He=Ue}}]);
//# sourceMappingURL=592.5c4fda18.js.map